create database hospitals;
CREATE TABLE patients (
    patient_id INT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    dob DATE NOT NULL,
    gender CHAR(1) CHECK (gender IN ('M', 'F', 'O'))
);
CREATE TABLE doctors (
    doctor_id INT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    department VARCHAR(50) NOT NULL
);
CREATE TABLE appointments (
    app_id INT PRIMARY key,
    patient_id INT,
    doctor_id INT,
    app_date DATE NOT NULL,
    FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
    FOREIGN KEY (doctor_id) REFERENCES doctors(doctor_id)
);
CREATE TABLE prescriptions (
    pres_id INT,
    app_id INT,
    medicine VARCHAR(100) NOT NULL,
    dosage_mg INT NOT NULL,
    FOREIGN KEY (app_id) REFERENCES appointments(app_id)
); 

INSERT INTO patients (patient_id, name, dob, gender) VALUES
(1, 'James Anderson', '1965-03-12', 'M'),
(2, 'Emma Wilson', '1988-07-25', 'F'),
(3, 'Michael Patel', '1972-11-03', 'M'),
(4, 'Sarah Nguyen', '1995-04-19', 'F'),
(5, 'David Kim', '1980-09-08', 'O'),
(6, 'Lisa Brown', '1975-12-15', 'F'),
(7, 'Robert Smith', '1982-06-22', 'M'),
(8, 'Maria Garcia', '1990-02-28', 'F'),
(9, 'Thomas Lee', '1987-08-10', 'M'),
(10, 'Emily Clark', '1993-10-14', 'F'),
(11, 'William Johnson', '1978-05-20', 'M'),
(12, 'Sophia Martinez', '1984-01-09', 'F'),
(13, 'Daniel Taylor', '1991-03-27', 'M'),
(14, 'Olivia Davis', '1989-11-11', 'F'),
(15, 'Charles Moore', '1977-07-07', 'M'),
(16, 'Ava Thompson', '1996-09-03', 'F'),
(17, 'Joseph White', '1983-12-28', 'M'),
(18, 'Mia Harris', '1990-04-19', 'F'),
(19, 'Henry Lewis', '1981-06-23', 'M'),
(20, 'Isabella Walker', '1989-08-15', 'F'),
(21, 'Andrew Young', '1976-02-14', 'M'),
(22, 'Charlotte Green', '1994-05-30', 'F'),
(23, 'Matthew Hall', '1986-10-02', 'M'),
(24, 'Amelia Adams', '1992-07-17', 'F'),
(25, 'Joshua Carter', '1980-03-04', 'M'),
(26, 'Harper Perez', '1988-11-22', 'F'),
(27, 'Ethan Roberts', '1979-09-09', 'M'),
(28, 'Evelyn Turner', '1991-12-12', 'F'),
(29, 'Ryan Phillips', '1985-04-25', 'M'),
(30, 'Abigail Campbell', '1993-06-08', 'F'),
(31, 'Benjamin Parker', '1978-01-15', 'M'),
(32, 'Chloe Evans', '1987-03-29', 'F'),
(33, 'Samuel Edwards', '1982-08-07', 'M'),
(34, 'Victoria Collins', '1990-10-21', 'F'),
(35, 'Henry Stewart', '1975-05-13', 'M'),
(36, 'Zoey Sanchez', '1995-02-26', 'F'),
(37, 'Alexander Morris', '1981-07-19', 'M'),
(38, 'Lily Rogers', '1989-09-04', 'F'),
(39, 'Gabriel Reed', '1984-11-27', 'M'),
(40, 'Grace Cox', '1992-01-16', 'F'),
(41, 'Lucas Bell', '1970-06-30', 'M'),
(42, 'Avery Murphy', '1986-12-05', 'F'),
(43, 'Nathan Rivera', '1994-03-14', 'M'),
(44, 'Sofia Cooper', '1983-08-18', 'F'),
(45, 'Jack Ward', '1976-04-22', 'M'),
(46, 'Ella Scott', '1991-09-07', 'F'),
(47, 'Liam Gray', '1985-02-13', 'M'),
(48, 'Aria King', '1997-11-30', 'F'),
(49, 'Owen Baker', '1979-06-25', 'M'),
(50, 'Scarlett Hill', '1988-01-08', 'F'),
(51, 'James Wilson', '1968-10-12', 'M'),
(52, 'Emma Patel', '1990-05-17', 'F'),
(53, 'Michael Nguyen', '1974-07-29', 'M'),
(54, 'Sarah Kim', '1993-02-04', 'F'),
(55, 'David Brown', '1981-12-20', 'O'),
(56, 'Lisa Smith', '1977-03-15', 'F'),
(57, 'Robert Garcia', '1984-09-09', 'M'),
(58, 'Maria Lee', '1992-06-23', 'F'),
(59, 'Thomas Clark', '1986-04-11', 'M'),
(60, 'Emily Johnson', '1995-08-27', 'F'),
(61, 'William Martinez', '1973-11-02', 'M'),
(62, 'Sophia Taylor', '1989-01-14', 'F'),
(63, 'Daniel Davis', '1980-07-19', 'M'),
(64, 'Olivia Moore', '1994-10-03', 'F'),
(65, 'Charles Thompson', '1976-05-28', 'M'),
(66, 'Ava White', '1991-12-12', 'F'),
(67, 'Joseph Harris', '1983-03-25', 'M'),
(68, 'Mia Lewis', '1987-09-08', 'F'),
(69, 'Henry Walker', '1979-06-14', 'M'),
(70, 'Isabella Young', '1993-02-28', 'F'),
(71, 'Andrew Green', '1975-08-10', 'M'),
(72, 'Charlotte Hall', '1990-04-05', 'F'),
(73, 'Matthew Adams', '1982-11-17', 'M'),
(74, 'Amelia Carter', '1996-07-22', 'F'),
(75, 'Joshua Perez', '1978-01-09', 'M'),
(76, 'Harper Roberts', '1989-10-15', 'F'),
(77, 'Ethan Turner', '1984-06-30', 'M'),
(78, 'Evelyn Phillips', '1992-03-14', 'F'),
(79, 'Ryan Campbell', '1977-12-01', 'M'),
(80, 'Abigail Parker', '1995-05-26', 'F'),
(81, 'Benjamin Evans', '1981-09-03', 'M'),
(82, 'Chloe Edwards', '1988-02-18', 'F'),
(83, 'Samuel Collins', '1976-07-07', 'M'),
(84, 'Victoria Stewart', '1993-11-22', 'F'),
(85, 'Henry Sanchez', '1980-04-16', 'M'),
(86, 'Zoey Morris', '1991-08-29', 'F'),
(87, 'Alexander Rogers', '1975-06-12', 'M'),
(88, 'Lily Reed', '1989-12-05', 'F'),
(89, 'Gabriel Cox', '1983-03-19', 'M'),
(90, 'Grace Bell', '1994-09-14', 'F'),
(91, 'Lucas Murphy', '1978-02-28', 'M'),
(92, 'Avery Rivera', '1990-06-23', 'F'),
(93, 'Nathan Cooper', '1985-11-08', 'M'),
(94, 'Sofia Ward', '1992-04-12', 'F'),
(95, 'Jack Scott', '1977-09-27', 'M'),
(96, 'Ella Gray', '1993-01-15', 'F'),
(97, 'Liam King', '1981-05-30', 'M'),
(98, 'Aria Baker', '1988-10-04', 'F'),
(99, 'Owen Hill', '1976-07-19', 'M'),
(100, 'Scarlett Wilson', '1994-02-25', 'F'),
(101, 'James Patel', '1979-08-10', 'M'),
(102, 'Emma Nguyen', '1991-03-14', 'F'),
(103, 'Michael Kim', '1983-12-01', 'O'),
(104, 'Sarah Brown', '1995-06-26', 'F'),
(105, 'David Smith', '1978-04-09', 'M'),
(106, 'Lisa Garcia', '1989-11-22', 'F'),
(107, 'Robert Lee', '1975-07-07', 'M'),
(108, 'Maria Clark', '1992-02-18', 'F'),
(109, 'Thomas Johnson', '1984-09-03', 'M'),
(110, 'Emily Martinez', '1990-05-30', 'F'),
(111, 'William Taylor', '1977-12-15', 'M'),
(112, 'Sophia Davis', '1993-08-29', 'F'),
(113, 'Daniel Moore', '1981-06-14', 'M'),
(114, 'Olivia Thompson', '1988-01-28', 'F'),
(115, 'Charles White', '1976-10-12', 'M'),
(116, 'Ava Harris', '1994-04-05', 'F'),
(117, 'Joseph Lewis', '1982-11-20', 'M'),
(118, 'Mia Walker', '1990-07-15', 'F'),
(119, 'Henry Young', '1978-03-01', 'M'),
(120, 'Isabella Green', '1995-09-14', 'F');
INSERT INTO patients (patient_id, name, dob, gender) VALUES
(121, 'Ethan Foster', '1980-02-11', 'M'),
(122, 'Madison Brooks', '1992-08-19', 'F'),
(123, 'Christopher Hayes', '1977-06-05', 'M'),
(124, 'Avery Bennett', '1994-11-23', 'F'),
(125, 'Jonathan Price', '1983-03-18', 'M'),
(126, 'Layla Simmons', '1991-09-09', 'F'),
(127, 'Brandon Hunt', '1979-12-27', 'M'),
(128, 'Zoe Lawson', '1993-07-04', 'F'),
(129, 'Patrick Fox', '1986-05-22', 'M'),
(130, 'Brooklyn Foster', '1995-10-30', 'F'),
(131, 'Dylan Stone', '1982-04-14', 'M'),
(132, 'Stella Fisher', '1990-12-18', 'F'),
(133, 'Aaron Murray', '1976-09-25', 'M'),
(134, 'Ellie Warren', '1992-02-07', 'F'),
(135, 'Jason Hayes', '1984-08-16', 'M'),
(136, 'Maya Bennett', '1996-01-29', 'F'),
(137, 'Connor Price', '1981-05-09', 'M'),
(138, 'Hannah Simmons', '1989-03-13', 'F'),
(139, 'Derek Hunt', '1978-07-21', 'M'),
(140, 'Natalie Lawson', '1993-11-02', 'F');

INSERT INTO doctors (doctor_id, name, department) VALUES
(1, 'Dr. Alan Thompson', 'Cardiology'),
(2, 'Dr. Betty Chen', 'Neurology'),
(3, 'Dr. Carl Rodriguez', 'Pediatrics'),
(4, 'Dr. Diana Patel', 'Orthopedics'),
(5, 'Dr. Edward Lee', 'General Medicine'),
(6, 'Dr. Fiona Nguyen', 'Dermatology'),
(7, 'Dr. George Kim', 'Oncology'),
(8, 'Dr. Helen Wilson', 'Endocrinology'),
(9, 'Dr. Ian Brown', 'Cardiology'),
(10, 'Dr. Jane Smith', 'Neurology'),
(11, 'Dr. Kevin Johnson', 'Pediatrics'),
(12, 'Dr. Laura Martinez', 'Orthopedics'),
(13, 'Dr. Mark Taylor', 'General Medicine'),
(14, 'Dr. Nancy Davis', 'Dermatology'),
(15, 'Dr. Oliver Moore', 'Oncology'),
(16, 'Dr. Patricia White', 'Endocrinology'),
(17, 'Dr. Quentin Harris', 'Cardiology'),
(18, 'Dr. Rachel Lewis', 'Neurology'),
(19, 'Dr. Steven Walker', 'Pediatrics'),
(20, 'Dr. Tina Young', 'Orthopedics'),
(21, 'Dr. Victor Green', 'General Medicine'),
(22, 'Dr. Wendy Hall', 'Dermatology'),
(23, 'Dr. Xavier Adams', 'Oncology'),
(24, 'Dr. Yvonne Carter', 'Endocrinology'),
(25, 'Dr. Zachary Perez', 'Cardiology'),
(26, 'Dr. Alice Roberts', 'Neurology'),
(27, 'Dr. Bob Turner', 'Pediatrics'),
(28, 'Dr. Clara Phillips', 'Orthopedics'),
(29, 'Dr. David Campbell', 'General Medicine'),
(30, 'Dr. Emma Parker', 'Dermatology'),
(31, 'Dr. Frank Evans', 'Oncology'),
(32, 'Dr. Grace Collins', 'Endocrinology'),
(33, 'Dr. Henry Stewart', 'Cardiology'),
(34, 'Dr. Irene Sanchez', 'Neurology'),
(35, 'Dr. Jack Morris', 'Pediatrics'),
(36, 'Dr. Karen Rogers', 'Orthopedics'),
(37, 'Dr. Larry Reed', 'General Medicine'),
(38, 'Dr. Monica Cox', 'Dermatology'),
(39, 'Dr. Nathan Bell', 'Oncology'),
(40, 'Dr. Olivia Murphy', 'Endocrinology'),
(41, 'Dr. Paul Rivera', 'Cardiology'),
(42, 'Dr. Quinn Cooper', 'Neurology'),
(43, 'Dr. Rose Ward', 'Pediatrics'),
(44, 'Dr. Sam Scott', 'Orthopedics'),
(45, 'Dr. Tara Gray', 'General Medicine'),
(46, 'Dr. Umar King', 'Dermatology'),
(47, 'Dr. Vera Baker', 'Oncology'),
(48, 'Dr. Will Hill', 'Endocrinology'),
(49, 'Dr. Xena Wilson', 'Cardiology'),
(50, 'Dr. Yasmin Patel', 'Neurology'),
(51, 'Dr. Zane Nguyen', 'Pediatrics'),
(52, 'Dr. Amy Kim', 'Orthopedics'),
(53, 'Dr. Brian Brown', 'General Medicine'),
(54, 'Dr. Cathy Smith', 'Dermatology'),
(55, 'Dr. Derek Johnson', 'Oncology'),
(56, 'Dr. Elise Martinez', 'Endocrinology'),
(57, 'Dr. Fred Taylor', 'Cardiology'),
(58, 'Dr. Gina Davis', 'Neurology'),
(59, 'Dr. Harry Moore', 'Pediatrics'),
(60, 'Dr. Ivy White', 'Orthopedics'),
(61, 'Dr. Jack Harris', 'General Medicine'),
(62, 'Dr. Kelly Lewis', 'Dermatology'),
(63, 'Dr. Leo Walker', 'Oncology'),
(64, 'Dr. Mia Young', 'Endocrinology'),
(65, 'Dr. Neil Green', 'Cardiology'),
(66, 'Dr. Nora Hall', 'Neurology'),
(67, 'Dr. Owen Adams', 'Pediatrics'),
(68, 'Dr. Paula Carter', 'Orthopedics'),
(69, 'Dr. Quincy Perez', 'General Medicine'),
(70, 'Dr. Rita Roberts', 'Dermatology'),
(71, 'Dr. Simon Turner', 'Oncology'),
(72, 'Dr. Tessa Phillips', 'Endocrinology'),
(73, 'Dr. Umar Campbell', 'Cardiology'),
(74, 'Dr. Violet Parker', 'Neurology'),
(75, 'Dr. Walter Evans', 'Pediatrics'),
(76, 'Dr. Xena Collins', 'Orthopedics'),
(77, 'Dr. Yasmin Stewart', 'General Medicine'),
(78, 'Dr. Zane Sanchez', 'Dermatology'),
(79, 'Dr. Amy Morris', 'Oncology'),
(80, 'Dr. Brian Rogers', 'Endocrinology'),
(81, 'Dr. Cathy Reed', 'Cardiology'),
(82, 'Dr. Derek Cox', 'Neurology'),
(83, 'Dr. Elise Bell', 'Pediatrics'),
(84, 'Dr. Fred Murphy', 'Orthopedics'),
(85, 'Dr. Gina Rivera', 'General Medicine'),
(86, 'Dr. Harry Cooper', 'Dermatology'),
(87, 'Dr. Ivy Ward', 'Oncology'),
(88, 'Dr. Jack Scott', 'Endocrinology'),
(89, 'Dr. Kelly Gray', 'Cardiology'),
(90, 'Dr. Leo King', 'Neurology'),
(91, 'Dr. Mia Baker', 'Pediatrics'),
(92, 'Dr. Neil Hill', 'Orthopedics'),
(93, 'Dr. Nora Wilson', 'General Medicine'),
(94, 'Dr. Owen Patel', 'Dermatology'),
(95, 'Dr. Paula Nguyen', 'Oncology'),
(96, 'Dr. Quincy Kim', 'Endocrinology'),
(97, 'Dr. Rita Brown', 'Cardiology'),
(98, 'Dr. Simon Smith', 'Neurology'),
(99, 'Dr. Tessa Johnson', 'Pediatrics'),
(100, 'Dr. Umar Martinez', 'Orthopedics'),
(101, 'Dr. Violet Taylor', 'General Medicine'),
(102, 'Dr. Walter Davis', 'Dermatology'),
(103, 'Dr. Xena Moore', 'Oncology'),
(104, 'Dr. Yasmin White', 'Endocrinology'),
(105, 'Dr. Zane Harris', 'Cardiology'),
(106, 'Dr. Amy Lewis', 'Neurology'),
(107, 'Dr. Brian Walker', 'Pediatrics'),
(108, 'Dr. Cathy Young', 'Orthopedics'),
(109, 'Dr. Derek Green', 'General Medicine'),
(110, 'Dr. Elise Hall', 'Dermatology'),
(111, 'Dr. Fred Adams', 'Oncology'),
(112, 'Dr. Gina Carter', 'Endocrinology'),
(113, 'Dr. Harry Perez', 'Cardiology'),
(114, 'Dr. Ivy Roberts', 'Neurology'),
(115, 'Dr. Jack Turner', 'Pediatrics'),
(116, 'Dr. Kelly Phillips', 'Orthopedics'),
(117, 'Dr. Leo Campbell', 'General Medicine'),
(118, 'Dr. Mia Parker', 'Dermatology'),
(119, 'Dr. Neil Evans', 'Oncology'),
(120, 'Dr. Nora Collins', 'Endocrinology'),
(121, 'Dr. Owen Stewart', 'Cardiology'),
(122, 'Dr. Paula Sanchez', 'Neurology'),
(123, 'Dr. Quincy Morris', 'Pediatrics'),
(124, 'Dr. Rita Rogers', 'Orthopedics'),
(125, 'Dr. Simon Reed', 'General Medicine'),
(126, 'Dr. Tessa Cox', 'Dermatology'),
(127, 'Dr. Umar Bell', 'Oncology'),
(128, 'Dr. Violet Murphy', 'Endocrinology'),
(129, 'Dr. Walter Rivera', 'Cardiology'),
(130, 'Dr. Xena Cooper', 'Neurology'),
(131, 'Dr. Yasmin Ward', 'Pediatrics'),
(132, 'Dr. Zane Scott', 'Orthopedics'),
(133, 'Dr. Amy Gray', 'General Medicine'),
(134, 'Dr. Brian King', 'Dermatology'),
(135, 'Dr. Cathy Baker', 'Oncology'),
(136, 'Dr. Derek Hill', 'Endocrinology'),
(137, 'Dr. Elise Wilson', 'Cardiology'),
(138, 'Dr. Fred Patel', 'Neurology'),
(139, 'Dr. Gina Nguyen', 'Pediatrics'),
(140, 'Dr. Harry Kim', 'Orthopedics'),
(141, 'Dr. Ivy Brown', 'General Medicine'),
(142, 'Dr. Jack Smith', 'Dermatology'),
(143, 'Dr. Kelly Johnson', 'Oncology'),
(144, 'Dr. Leo Martinez', 'Endocrinology'),
(145, 'Dr. Mia Taylor', 'Cardiology'),
(146, 'Dr. Neil Davis', 'Neurology'),
(147, 'Dr. Nora Moore', 'Pediatrics'),
(148, 'Dr. Owen White', 'Orthopedics'),
(149, 'Dr. Paula Harris', 'General Medicine'),
(150, 'Dr. Quincy Lewis', 'Dermatology');

INSERT INTO doctors (doctor_id, name, department) VALUES
(151, 'Dr. Adrian Foster', 'Cardiology'),
(152, 'Dr. Bella Knight', 'Neurology'),
(153, 'Dr. Charles Hughes', 'Pediatrics'),
(154, 'Dr. Daniela Scott', 'Orthopedics'),
(155, 'Dr. Ethan Price', 'General Medicine'),
(156, 'Dr. Felicia Morgan', 'Dermatology'),
(157, 'Dr. Gabriel Stone', 'Oncology'),
(158, 'Dr. Hannah Fisher', 'Endocrinology'),
(159, 'Dr. Isaac Murray', 'Cardiology'),
(160, 'Dr. Julia Bennett', 'Neurology'),
(161, 'Dr. Kevin Foster', 'Pediatrics'),
(162, 'Dr. Lydia Brooks', 'Orthopedics'),
(163, 'Dr. Marcus Clark', 'General Medicine'),
(164, 'Dr. Natalie Ross', 'Dermatology'),
(165, 'Dr. Oliver Hayes', 'Oncology'),
(166, 'Dr. Penelope Ward', 'Endocrinology'),
(167, 'Dr. Quentin Fox', 'Cardiology'),
(168, 'Dr. Rebecca Simmons', 'Neurology'),
(169, 'Dr. Samuel Hunt', 'Pediatrics'),
(170, 'Dr. Teresa Lawson', 'Orthopedics');

INSERT INTO appointments (app_id, patient_id, doctor_id, app_date) VALUES
(1, 1, 1, '2024-01-15'),
(2, 2, 2, '2024-02-10'),
(3, 3, 3, '2024-03-22'),
(4, 4, 4, '2024-04-05'),
(5, 5, 5, '2024-05-18'),
(6, 6, 6, '2024-06-12'),
(7, 7, 7, '2024-07-20'),
(8, 8, 8, '2024-08-15'),
(9, 9, 9, '2024-09-03'),
(10, 10, 10, '2024-10-10'),
(11, 11, 11, '2024-11-25'),
(12, 12, 12, '2024-12-08'),
(13, 13, 13, '2025-01-14'),
(14, 14, 14, '2025-02-19'),
(15, 15, 15, '2025-03-27'),
(16, 16, 16, '2025-04-02'),
(17, 17, 17, '2025-05-16'),
(18, 18, 18, '2025-06-23'),
(19, 19, 19, '2025-07-09'),
(20, 20, 20, '2025-08-12'),
(21, 21, 21, '2024-01-30'),
(22, 22, 22, '2024-02-25'),
(23, 23, 23, '2024-03-10'),
(24, 24, 24, '2024-04-15'),
(25, 25, 25, '2024-05-20'),
(26, 26, 26, '2024-06-05'),
(27, 27, 27, '2024-07-12'),
(28, 28, 28, '2024-08-28'),
(29, 29, 29, '2024-09-15'),
(30, 30, 30, '2024-10-22'),
(31, 31, 31, '2024-11-07'),
(32, 32, 32, '2024-12-12'),
(33, 33, 33, '2025-01-28'),
(34, 34, 34, '2025-02-14'),
(35, 35, 35, '2025-03-05'),
(36, 36, 36, '2025-04-10'),
(37, 37, 37, '2025-05-25'),
(38, 38, 38, '2025-06-15'),
(39, 39, 39, '2025-07-20'),
(40, 40, 40, '2025-08-05'),
(41, 41, 41, '2024-01-20'),
(42, 42, 42, '2024-02-15'),
(43, 43, 43, '2024-03-30'),
(44, 44, 44, '2024-04-25'),
(45, 45, 45, '2024-05-10'),
(46, 46, 46, '2024-06-20'),
(47, 47, 47, '2024-07-15'),
(48, 48, 48, '2024-08-10'),
(49, 49, 49, '2024-09-25'),
(50, 50, 50, '2024-10-05'),
(51, 51, 51, '2024-11-12'),
(52, 52, 52, '2024-12-20'),
(53, 53, 53, '2025-01-10'),
(54, 54, 54, '2025-02-25'),
(55, 55, 55, '2025-03-15'),
(56, 56, 56, '2025-04-20'),
(57, 57, 57, '2025-05-05'),
(58, 58, 58, '2025-06-12'),
(59, 59, 59, '2025-07-25'),
(60, 60, 60, '2025-08-15'),
(61, 61, 61, '2024-01-25'),
(62, 62, 62, '2024-02-20'),
(63, 63, 63, '2024-03-05'),
(64, 64, 64, '2024-04-10'),
(65, 65, 65, '2024-05-15'),
(66, 66, 66, '2024-06-25'),
(67, 67, 67, '2024-07-10'),
(68, 68, 68, '2024-08-20'),
(69, 69, 69, '2024-09-10'),
(70, 70, 70, '2024-10-15'),
(71, 71, 71, '2024-11-20'),
(72, 72, 72, '2024-12-25'),
(73, 73, 73, '2025-01-15'),
(74, 74, 74, '2025-02-10'),
(75, 75, 75, '2025-03-20'),
(76, 76, 76, '2025-04-05'),
(77, 77, 77, '2025-05-10'),
(78, 78, 78, '2025-06-20'),
(79, 79, 79, '2025-07-15'),
(80, 80, 80, '2025-08-20'),
(81, 81, 81, '2024-01-10'),
(82, 82, 82, '2024-02-05'),
(83, 83, 83, '2024-03-15'),
(84, 84, 84, '2024-04-20'),
(85, 85, 85, '2024-05-25'),
(86, 86, 86, '2024-06-10'),
(87, 87, 87, '2024-07-20'),
(88, 88, 88, '2024-08-05'),
(89, 89, 89, '2024-09-20'),
(90, 90, 90, '2024-10-25'),
(91, 91, 91, '2024-11-15'),
(92, 92, 92, '2024-12-10'),
(93, 93, 93, '2025-01-20'),
(94, 94, 94, '2025-02-15'),
(95, 95, 95, '2025-03-25'),
(96, 96, 96, '2025-04-15'),
(97, 97, 97, '2025-05-20'),
(98, 98, 98, '2025-06-05'),
(99, 99, 99, '2025-07-10'),
(100, 100, 100, '2025-08-25'),
(101, 101, 101, '2024-01-05'),
(102, 102, 102, '2024-02-20'),
(103, 103, 103, '2024-03-10'),
(104, 104, 104, '2024-04-15'),
(105, 105, 105, '2024-05-20'),
(106, 106, 106, '2024-06-25'),
(107, 107, 107, '2024-07-05'),
(108, 108, 108, '2024-08-15'),
(109, 109, 109, '2024-09-20'),
(110, 110, 110, '2024-10-10'),
(111, 111, 111, '2024-11-25'),
(112, 112, 112, '2024-12-05'),
(113, 113, 113, '2025-01-15'),
(114, 114, 114, '2025-02-20'),
(115, 115, 115, '2025-03-05'),
(116, 116, 116, '2025-04-10'),
(117, 117, 117, '2025-05-15'),
(118, 118, 118, '2025-06-20'),
(119, 119, 119, '2025-07-25'),
(120, 120, 120, '2025-08-10'),
(121, 1, 121, '2024-01-20'),
(122, 2, 122, '2024-02-25'),
(123, 3, 123, '2024-03-30'),
(124, 4, 124, '2024-04-05'),
(125, 5, 125, '2024-05-10'),
(126, 6, 126, '2024-06-15'),
(127, 7, 127, '2024-07-20'),
(128, 8, 128, '2024-08-25'),
(129, 9, 129, '2024-09-30'),
(130, 10, 130, '2024-10-05'),
(131, 11, 131, '2024-11-10'),
(132, 12, 132, '2024-12-15'),
(133, 13, 133, '2025-01-20'),
(134, 14, 134, '2025-02-25'),
(135, 15, 135, '2025-03-30'),
(136, 16, 136, '2025-04-05'),
(137, 17, 137, '2025-05-10'),
(138, 18, 138, '2025-06-15'),
(139, 19, 139, '2025-07-20'),
(140, 20, 140, '2025-08-25'),
(141, 21, 141, '2024-01-15'),
(142, 22, 142, '2024-02-20'),
(143, 23, 143, '2024-03-25'),
(144, 24, 144, '2024-04-30'),
(145, 25, 145, '2024-05-05'),
(146, 26, 146, '2024-06-10'),
(147, 27, 147, '2024-07-15'),
(148, 28, 148, '2024-08-20'),
(149, 29, 149, '2024-09-25'),
(150, 30, 150, '2024-10-30');
INSERT INTO appointments (app_id, patient_id, doctor_id, app_date) VALUES
(151, 31, 151, '2024-11-05'),
(152, 32, 152, '2024-12-18'),
(153, 33, 153, '2025-01-22'),
(154, 34, 154, '2025-02-28'),
(155, 35, 155, '2025-03-12'),
(156, 36, 156, '2025-04-08'),
(157, 37, 157, '2025-05-19'),
(158, 38, 158, '2025-06-25'),
(159, 39, 159, '2025-07-14'),
(160, 40, 160, '2025-08-29'),
(161, 41, 161, '2024-11-10'),
(162, 42, 162, '2024-12-22'),
(163, 43, 163, '2025-01-30'),
(164, 44, 164, '2025-02-18'),
(165, 45, 165, '2025-03-27'),
(166, 46, 166, '2025-04-15'),
(167, 47, 167, '2025-05-21'),
(168, 48, 168, '2025-06-28'),
(169, 49, 169, '2025-07-18'),
(170, 50, 170, '2025-08-12');

INSERT INTO prescriptions (pres_id, app_id, medicine, dosage_mg) VALUES
(1, 1, 'Paracetamol', 500),
(2, 1, 'Ibuprofen', 400),
(3, 2, 'Amoxicillin', 500),
(4, 2, 'Lisinopril', 10),
(5, 3, 'Metformin', 1000),
(6, 3, 'Atorvastatin', 20),
(7, 4, 'Cephalexin', 500),
(8, 4, 'Gabapentin', 300),
(9, 5, 'Levothyroxine', 50),
(10, 5, 'Sertraline', 50),
(11, 6, 'Aspirin', 81),
(12, 6, 'Omeprazole', 20),
(13, 7, 'Losartan', 50),
(14, 7, 'Clobetasol', 0.05),
(15, 8, 'Cisplatin', 50),
(16, 8, 'Insulin', 10),
(17, 9, 'Amlodipine', 5),
(18, 9, 'Lamotrigine', 100),
(19, 10, 'Azithromycin', 250),
(20, 10, 'Prednisone', 10),
(21, 11, 'Paracetamol', 1000),
(22, 11, 'Ibuprofen', 200),
(23, 12, 'Amoxicillin', 250),
(24, 12, 'Lisinopril', 20),
(25, 13, 'Metformin', 500),
(26, 13, 'Atorvastatin', 40),
(27, 14, 'Cephalexin', 250),
(28, 14, 'Gabapentin', 600),
(29, 15, 'Levothyroxine', 100),
(30, 15, 'Sertraline', 100),
(31, 16, 'Aspirin', 325),
(32, 16, 'Omeprazole', 40),
(33, 17, 'Losartan', 100),
(34, 17, 'Clobetasol', 0.1),
(35, 18, 'Cisplatin', 100),
(36, 18, 'Insulin', 20),
(37, 19, 'Amlodipine', 10),
(38, 19, 'Lamotrigine', 200),
(39, 20, 'Azithromycin', 500),
(40, 20, 'Prednisone', 20),
(41, 21, 'Paracetamol', 250),
(42, 21, 'Ibuprofen', 400),
(43, 22, 'Amoxicillin', 500),
(44, 22, 'Lisinopril', 5),
(45, 23, 'Metformin', 1000),
(46, 23, 'Atorvastatin', 10),
(47, 24, 'Cephalexin', 500),
(48, 24, 'Gabapentin', 100),
(49, 25, 'Levothyroxine', 25),
(50, 25, 'Sertraline', 25),
(51, 26, 'Aspirin', 81),
(52, 26, 'Omeprazole', 20),
(53, 27, 'Losartan', 25),
(54, 27, 'Clobetasol', 0.05),
(55, 28, 'Cisplatin', 50),
(56, 28, 'Insulin', 10),
(57, 29, 'Amlodipine', 5),
(58, 29, 'Lamotrigine', 25),
(59, 30, 'Azithromycin', 250),
(60, 30, 'Prednisone', 5),
(61, 31, 'Paracetamol', 1000),
(62, 31, 'Ibuprofen', 200),
(63, 32, 'Amoxicillin', 250),
(64, 32, 'Lisinopril', 10),
(65, 33, 'Metformin', 500),
(66, 33, 'Atorvastatin', 20),
(67, 34, 'Cephalexin', 250),
(68, 34, 'Gabapentin', 300),
(69, 35, 'Levothyroxine', 50),
(70, 35, 'Sertraline', 50),
(71, 36, 'Aspirin', 325),
(72, 36, 'Omeprazole', 40),
(73, 37, 'Losartan', 50),
(74, 37, 'Clobetasol', 0.1),
(75, 38, 'Cisplatin', 100),
(76, 38, 'Insulin', 20),
(77, 39, 'Amlodipine', 10),
(78, 39, 'Lamotrigine', 100),
(79, 40, 'Azithromycin', 500),
(80, 40, 'Prednisone', 10),
(81, 41, 'Paracetamol', 500),
(82, 41, 'Ibuprofen', 400),
(83, 42, 'Amoxicillin', 500),
(84, 42, 'Lisinopril', 20),
(85, 43, 'Metformin', 1000),
(86, 43, 'Atorvastatin', 40),
(87, 44, 'Cephalexin', 500),
(88, 44, 'Gabapentin', 600),
(89, 45, 'Levothyroxine', 100),
(90, 45, 'Sertraline', 100),
(91, 46, 'Aspirin', 81),
(92, 46, 'Omeprazole', 20),
(93, 47, 'Losartan', 100),
(94, 47, 'Clobetasol', 0.05),
(95, 48, 'Cisplatin', 50),
(96, 48, 'Insulin', 10),
(97, 49, 'Amlodipine', 5),
(98, 49, 'Lamotrigine', 200),
(99, 50, 'Azithromycin', 250),
(100, 50, 'Prednisone', 20),
(101, 51, 'Paracetamol', 1000),
(102, 51, 'Ibuprofen', 200),
(103, 52, 'Amoxicillin', 250),
(104, 52, 'Lisinopril', 5),
(105, 53, 'Metformin', 500),
(106, 53, 'Atorvastatin', 10),
(107, 54, 'Cephalexin', 250),
(108, 54, 'Gabapentin', 100),
(109, 55, 'Levothyroxine', 25),
(110, 55, 'Sertraline', 25),
(111, 56, 'Aspirin', 325),
(112, 56, 'Omeprazole', 40),
(113, 57, 'Losartan', 25),
(114, 57, 'Clobetasol', 0.1),
(115, 58, 'Cisplatin', 100),
(116, 58, 'Insulin', 20),
(117, 59, 'Amlodipine', 10),
(118, 59, 'Lamotrigine', 25),
(119, 60, 'Azithromycin', 500),
(120, 60, 'Prednisone', 5),
(121, 61, 'Paracetamol', 500),
(122, 61, 'Ibuprofen', 400),
(123, 62, 'Amoxicillin', 500),
(124, 62, 'Lisinopril', 10),
(125, 63, 'Metformin', 1000),
(126, 63, 'Atorvastatin', 20),
(127, 64, 'Cephalexin', 500),
(128, 64, 'Gabapentin', 300),
(129, 65, 'Levothyroxine', 50),
(130, 65, 'Sertraline', 50),
(131, 66, 'Aspirin', 81),
(132, 66, 'Omeprazole', 20),
(133, 67, 'Losartan', 50),
(134, 67, 'Clobetasol', 0.05),
(135, 68, 'Cisplatin', 50),
(136, 68, 'Insulin', 10),
(137, 69, 'Amlodipine', 5),
(138, 69, 'Lamotrigine', 100),
(139, 70, 'Azithromycin', 250),
(140, 70, 'Prednisone', 10),
(141, 71, 'Paracetamol', 1000),
(142, 71, 'Ibuprofen', 200),
(143, 72, 'Amoxicillin', 250),
(144, 72, 'Lisinopril', 20),
(145, 73, 'Metformin', 500),
(146, 73, 'Atorvastatin', 40),
(147, 74, 'Cephalexin', 250),
(148, 74, 'Gabapentin', 600),
(149, 75, 'Levothyroxine', 100),
(150, 75, 'Sertraline', 100);
INSERT INTO prescriptions (pres_id, app_id, medicine, dosage_mg) VALUES
(151, 76, 'Paracetamol' 'Ibuprofen' 'Lisinopril' 'Atorvastatin''Gabapentin'  'Levothyroxine', 500),
(152, 76, 'Ibuprofen', 400),
(153, 76, 'Amoxicillin', 250),
(154, 76, 'Lisinopril', 10),
(155, 77, 'Metformin', 1000),
(156, 77, 'Atorvastatin' 'Levothyroxine' 'Cephalexin''Metformin' 'Amoxicillin' 'Sertraline',40),
(157, 77, 'Cephalexin', 500),
(158, 78, 'Gabapentin', 300),
(159, 78, 'Levothyroxine', 50),
(160, 78, 'Sertraline', 50),
(161, 79, 'Aspirin', 81),
(162, 79, 'Omeprazole', 20),
(163, 79, 'Losartan', 50),
(164, 79, 'Clobetasol', 0.1),
(165, 80, 'Cisplatin', 50),
(166, 80, 'Insulin', 20),
(167, 80, 'Amlodipine', 5),
(168, 80, 'Lamotrigine', 100),
(169, 80, 'Azithromycin', 250),
(170, 81, 'Prednisone', 10);


#Find doctors with the most appointments in the last 30 days. 
SELECT d.doctor_id,
       d.name AS doctor_name,
       d.department,
       COUNT(a.app_id) AS total_appointments
FROM appointments a
JOIN doctors d ON a.doctor_id = d.doctor_id
WHERE a.app_date >= CURDATE() - INTERVAL 30 DAY
GROUP BY d.doctor_id, d.name, d.department
ORDER BY total_appointments DESC;


#Count patients per department.  
SELECT d.department,
       COUNT(DISTINCT a.patient_id) AS total_patients
FROM doctors d
JOIN appointments a ON d.doctor_id = a.doctor_id
JOIN patients p ON a.patient_id = p.patient_id
GROUP BY d.department
ORDER BY total_patients DESC;
select*from prescriptions;


#Identify the most prescribed medicine overall.  
SELECT prescriptions.medicine,
       COUNT(*) AS prescription_count
FROM prescriptions 
GROUP BY prescriptions.medicine
ORDER BY prescription_count DESC
LIMIT 1;


#List patients who visited more than 2 departments.  
SELECT p.patient_id,
       p.name AS patient_name,
       COUNT(DISTINCT d.department) AS department_count
FROM patients p
JOIN appointments a ON p.patient_id = a.patient_id
JOIN doctors d ON a.doctor_id = d.doctor_id
GROUP BY p.patient_id, p.name
HAVING COUNT(DISTINCT d.department) > 1
ORDER BY department_count DESC;
/* ANS = No Patients have visited more than two*/


#Calculate the average number of appointments per patient.  
SELECT 
    ROUND(AVG(appointment_count),2) AS avg_appointments_per_patient
FROM (
    SELECT p.patient_id, COUNT(a.app_id) AS appointment_count
    FROM patients p
    JOIN appointments a ON p.patient_id = a.patient_id
    GROUP BY p.patient_id
) AS sub;


#List doctors who have prescribed more than 5 different medicines. 
SELECT d.doctor_id,
       d.name AS doctor_name,
       d.department,
       COUNT(DISTINCT p.medicine) AS unique_medicines_prescribed
FROM doctors d
JOIN appointments a ON d.doctor_id = a.doctor_id
JOIN prescriptions p ON a.app_id = p.app_id
GROUP BY d.doctor_id, d.name, d.department
HAVING COUNT(DISTINCT p.medicine) >= 5
ORDER BY unique_medicines_prescribed DESC;


#Find the top 3 most commonly prescribed dosages for "Paracetamol".  
SELECT 
    dosage_mg,
    COUNT(*) AS prescription_count
FROM prescriptions
WHERE medicine = 'Paracetamol'
GROUP BY dosage_mg
ORDER BY prescription_count DESC
LIMIT 3;


#Calculate the average time between appointments for each patient.  
SELECT patient_id,
	ROUND(AVG(DATEDIFF(app_date, prev_app_date)),0) AS avg_days_between_appointments
FROM (
SELECT a.patient_id,
           a.app_date,
LAG(a.app_date) OVER (PARTITION BY a.patient_id ORDER BY a.app_date) AS prev_app_date
FROM appointments a
) t
WHERE prev_app_date IS NOT NULL
GROUP BY patient_id;


#Identify patients with appointments across at least 3 different months.   
SELECT 
    p.patient_id,
    p.name,
    COUNT(DISTINCT MONTH(a.app_date)) AS month_count
FROM patients p
JOIN appointments a ON p.patient_id = a.patient_id
GROUP BY p.patient_id,
    p.name
HAVING 
    COUNT(DISTINCT MONTH(a.app_date)) >=1 /* can use 2 to see the result
                                           but in that case it will show blank table*/
ORDER BY p.patient_id;
/* Patients donâ€™t have appointments in multiple months*/


#Find the department with the highest number of unique patients.   
SELECT d.department,
       COUNT(DISTINCT a.patient_id) AS unique_patients
FROM doctors d
JOIN appointments a ON d.doctor_id = a.doctor_id
JOIN patients p
ON a.patient_id = p.patient_id
GROUP BY d.department
ORDER BY unique_patients DESC
limit 1;